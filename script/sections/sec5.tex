% !TeX root = ../script.tex

\section{Die schnelle Fourier-Transformation}

Im folgenden Abschnitt wollen wir uns mit der schnellen Fourier-Transformation (\glqq{FFT} - fast Fourier transform) 
als zentrales Werkzeug der Signalverarbeitung und Bildkompression. 
Um die Idee hinter dem FFT-Algorithmus zu verstehen beginnen wir mit einer kurzen Wiederholung zu Fourier-Reihen.

\subsection{Fourier-Reihen}
Wir betrachten $f$ eine $2\pi$-periodische Funktion (d.h. $f(x+2\pi)=f(x)$ für alle $x\in\mathbb{R}$) mit 
dem Ziel eine Annäherung durch Linearkombinationen $2\pi$-periodischen Funktionen $\{\cos(kx)\}_{k=0}^{n}$ und 
$\{\sin(kx)\}_{k=1}^{n}$ zu finden:
\begin{align*}
  g_n(x) = \dfrac{1}{2}a_0 + \sum_{k=1}^{n}\Big(a_k\cos(kx)+b_k\sin(kx)\Big)
\end{align*}
Wir suchen eine Approximation im Sinne der $L_2$ Norm, d.h. wir minimieren den Ausdruck
\begin{align*}
  \vertn{2}{g_n(x)-f(x)}_2 = \left(\int_{-\pi}^{\pi} (g_n(x)-f(x))^2 \diff x\right)^{1/2}
\end{align*}

\begin{colbox}{Satz}[Fourier-Koeffizienten]
  Für trigonometrisches Polynom, d.h. eine Funktion der Form  
  %
  \begin{align*}
    g_n(x) = \dfrac{1}{2}a_0 + \sum_{k=1}^{n}\Big(a_k\cos(kx)+b_k\sin(kx)\Big)
  \end{align*}
  %
  gilt 
  %
  \begin{align*}
    a_k 
    &= \dfrac{1}{\pi} \int_{0}^{2\pi} g_n(x)\cos(kx) \diff x, \quad k=0,1,\dots,n \\
    b_k 
    &= \dfrac{1}{\pi} \int_{0}^{2\pi} g_n(x)\sin(kx) \diff x, \quad k=1,\dots,n 
  \end{align*}
  %
\end{colbox}

\textit{Beweis.} Durch Verwendung der Orthogonalitätsbedingungen der trigonometrischen Funktionen
%
% \begin{align*}
%   \int_{0}^{2\pi} \cos(kx)\cos(lx) \diff x 
%   &= \begin{cases}
%     \pi, & \text{falls } k = l \neq 0, \\
%     2\pi, & \text{falls } k = l = 0, \\
%     0, & \text{falls } k \neq l,
%   \end{cases}
%   \\
%   \int_{0}^{2\pi} \sin(kx)\sin(lx) \diff x 
%   &= \begin{cases}
%   \pi, & \text{falls } k = l, \\
%   0, & \text{falls } k \neq l,
%   \end{cases}
%   \\
%   \int_{0}^{2\pi} \cos(kx)\sin(lx)\diff x &= 0
% \end{align*}
% %
ergibt sich für $l=0$:
%
\begin{align*}
  \dfrac{1}{\pi} \int_{0}^{2\pi} g_n(x)\underbrace{\cos(lx)}_{1} \diff x 
  &= \dfrac{1}{\pi} \int_{0}^{2\pi} \left(\dfrac{1}{2}a_0 + \sum_{k=1}^{n}\Big(a_k\cos(kx)+b_k\sin(kx)\Big)\right)\cdot 1 \diff x \\
  &= \dfrac{1}{2\pi} a_0\cdot \int_{0}^{2\pi} 1 \diff x
  + \sum_{k=1}^n \left(
    \dfrac{1}{\pi} a_k \cdot\underbrace{\int_{0}^{2\pi} \cos(kx) \diff x}_{0} 
    + \dfrac{1}{\pi} b_k \cdot \underbrace{\int_{0}^{2\pi} \sin(kx)\diff x}_{0}
  \right) \\
  &= \dfrac{1}{2\pi} a_0 \cdot 2\pi = a_0
\end{align*}
%
und für $1\leq l \leq n$:
\begin{align*}
  &\dfrac{1}{\pi} \int_{0}^{2\pi} g_n(x)\cos(lx) \diff x \\
  &\qquad= \dfrac{1}{2\pi} a_0 \cdot\underbrace{\int_{0}^{2\pi} \cos(lx) \diff x}_{0}
  + \sum_{k=1}^n \left(
    \dfrac{1}{\pi}a_k\cdot\underbrace{\int_{0}^{2\pi} \cos(kx)\cos(lx) \diff x}_{\pi\text{ wenn } l=k, \text{ sonst } 0}
    + \dfrac{1}{\pi} b_k\cdot\underbrace{\int_{0}^{2\pi} \sin(kx)\cos(lx)\diff x}_{0}
  \right) \\
  &\qquad= \dfrac{1}{\pi} a_l \cdot \pi = a_l
\end{align*}
und 
\begin{align*}
  &\dfrac{1}{\pi} \int_{0}^{2\pi} g_n(x)\sin(lx) \diff x \\
  &\qquad= \dfrac{1}{2\pi} a_0\cdot \underbrace{\int_{0}^{2\pi} \sin(lx) \diff x}_{0}
  + \sum_{k=1}^n \left(
    \dfrac{1}{\pi}a_k\cdot\underbrace{\int_{0}^{2\pi} \cos(kx)\sin(lx) \diff x}_{0}
    + \dfrac{1}{\pi} b_k\cdot\underbrace{\int_{0}^{2\pi} \sin(kx)\sin(lx)\diff x}_{\pi\text{ wenn } l=k, \text{ sonst } 0}
  \right) \\
  &\qquad= \dfrac{1}{\pi} b_l \cdot \pi = b_l
\end{align*}
\qed
%

In Unserem Fall, wo wir $f$ durch $g_n$ annähern wollen verwenden wir daher $f(x)$ bei der Bestimmung unserer 
Koeffizienten.

Im Allgemeinen ergeben sich für die Fourier-Koeffizienten $\{a_k\}_{k=0}^n$ und $\{b_k\}_{k=1}^n$ keine geschlossenen 
Formeln, d.h. wir sind auf numerische Integration angewiesen um diese zu bestimmen.

Verenden wir die Trapezregel als Quadraturformel um diese numerische Integration durchzuführen:

\begin{colbox}{Definition}[Trapezregel]
  Ein Verfahren zur numerischen Integration einer Funktion $f:[a,b]\to\R$ wird durch die Trapezregel beschrieben. Sie 
  beruht auf der Idee das Intervall $[a,b]$ in kleinere Intervalle $[x_j, x_{j+1}]$ für $j=0,\dots,N-1$ mit 
  $a=x_0<x_1<\dots<x_N=b$ aufzuteilen und die Funktion auf jedem dieser Intervalle als linear anzunehmen, 
  dies ermöglicht folgende Annäherung 
  %
  \begin{align*}
    \int_{x_j}^{x_{j+1}} f(x) \diff x \approx (x_{j+1}-x_j)\cdot\dfrac{f(x_{j+1})+f(x_j)}{2}
  \end{align*}
  %
  Insbesondere für den Fall von äquidistant gewählten Stützstellen mit Schrittweite $h=\tfrac{b-a}{N}$ ergibt sich
  %
  \begin{align*}
    \int_{a}^{b} f(x) \diff x \approx \dfrac{h}{2}\left(f(a) + 2\cdot\sum_{j=1}^{N-1}f(a + h\cdot j) + f(b) \right)
  \end{align*}
  %
\end{colbox}

Verwenden wir diese Trapezregel mit $x_j=\tfrac{2\pi}{N}\cdot j$ um unsere Fourier-Koeffizienten anzunähern 
ergibt sich die diskrete Fourier-Transformation:
%
\begin{align*}
  a_k &\approx\dfrac{\pi}{N}\left(f(x_0)\cdot\cos(kx_0) 
  + 2\sum_{j=1}^{N-1} f(x_j)\cdot\cos(kx_j) + f(x_N)\cdot \cos(kx_N)\right) \\
  b_k &\approx\dfrac{\pi}{N}\left(f(x_0)\cdot\sin(kx_0)  
  + 2\sum_{j=1}^{N-1} f(x_j)\cdot\sin(kx_j) + f(x_N)\cdot \sin(kx_N)\right)
\end{align*}
%
Mit Berücksichtigung der $2\pi$-Periodizität von $f$ ergeben sich für $a_k$ und $b_k$ die Näherungswerte
%
\begin{align*}
  a_k^* &:= \dfrac{2}{N}\sum{j=1}^N f(x_j)\cdot \cos(kx_j), \quad k=0,1,2,\dots \\
  b_k^* &:= \dfrac{2}{N}\sum{j=1}^N f(x_j)\cdot \cos(kx_j), \quad k=1,2,3\dots
\end{align*}

\begin{colbox}{Satz}
  Für die diskreten Stützstellen $x_j=\tfrac{2\pi}{N}\cdot j$ mit $1\leq N$  gilt
  %
  \begin{align*}
    \sum_{j=1}^N \cos(kx_j) 
    &= \begin{cases}
      0, & \text{falls } \tfrac{k}{N}\notin\mathbb{Z} \\
      N, & \text{falls } \tfrac{k}{N}\in\mathbb{Z}
    \end{cases} \\
    \sum_{j=1}^N \sin(kx_j) 
    &= 0 \text{für alle } k\in\mathbb{Z}
  \end{align*}
\end{colbox}
\textit{Beweis.}
Wir betrachten die komplexe Kombination beider Ausdrücke und erhalten
%
\begin{align*}
  S_N := \sum_{j=1}^{N} \cos(kx_j) + i\sin(kx_j) = \sum_{j=1}^{N} e^{ikx_j} = \sum_{j=1}^{N} e^{ik\cdot jh}
\end{align*}%
Dies ist eine endliche geometrische Reihe mit komplexem $q := e^{ikh} = e^{2\pi ik/N}$

Ist $\tfrac{k}{N}\notin\mathbb{Z}$, dann ist $q\neq 1$, und die Summenformel der endlichen geometrischen Reihe ergibt 
%
\begin{align*}
   S_N 
   = e^{ikh}\dfrac{e^{ikhN}-1}{e^{ikh}-1} 
   = e^{ikh}\cdot\dfrac{e^{2\pi ki}-1}{e^{ikh}-1} 
   = 0, \text{wenn } \dfrac{k}{N}\notin\mathbb{Z}
\end{align*}
%
Für $\tfrac{k}{N}\in\mathbb{Z}$ folgt wegen $q=1$, dass $S=N$ ist. \\
Betrachtung on Realteilt und Imaginärteil liefert die Behauptung.

\textcolor{red}{Intuition Bilder}

\begin{colbox}{Satz}
  Die trigonometrischen Funktionen erfüllen für die äquidistanten Stützstellen $x_j$ die diskreten Orthogonalitätsrelationen
  \begin{align*}
    \sum_{j=1}^{N} \cos(kx_j)\cos(lx_j) = \begin{cases}
      0, &\text{falls } \tfrac{k+l}{N}\notin \mathbb{Z} \text{ und } \tfrac{k-l}{N}\notin \mathbb{Z} \\
      \tfrac{N}{2} &\text{falls entweder } \tfrac{k+l}{N}\in \mathbb{Z} \text{ oder } \tfrac{k-l}{N}\in \mathbb{Z} \\
      N &\text{falls } \tfrac{k+l}{N}\in \mathbb{Z} \text{ und } \tfrac{k-l}{N}\in \mathbb{Z}
    \end{cases}
  \end{align*}
  und 
  \begin{align*}
    \sum_{j=1}^{N} \sin(kx_j)\sin(lx_j) = \begin{cases}
      0, &\text{falls } \tfrac{k+l}{N}\notin \mathbb{Z} \text{ und } \tfrac{k-l}{N}\notin \mathbb{Z} \\
      0 &\text{falls } \tfrac{k+l}{N}\in \mathbb{Z} \text{ und } \tfrac{k-l}{N}\in \mathbb{Z} \\
      -\tfrac{N}{2} &\text{falls } \tfrac{k+l}{N}\in \mathbb{Z} \text{ und } \tfrac{k-l}{N}\notin \mathbb{Z} \\
      \tfrac{N}{2} &\text{falls } \tfrac{k+l}{N}\notin \mathbb{Z} \text{ und } \tfrac{k-l}{N}\in \mathbb{Z}
    \end{cases}
  \end{align*}
  und 
  \begin{align*}
    \sum_{j=1}^{N} \cos(kx_j)\sin(lx_j) = 0 \quad \text{für all } k,l\in\mathbb{N}
  \end{align*}
\end{colbox}
\textit{Beweis.} Zur Überprüfung der Orthogonalitätsrelationen werden die trigonometrischen Identitäten
\begin{align*}
  \cos(kx_j)\cos(lx_j) = \tfrac{1}{2}\Big(\cos(\big(k+l\big)x_j) + \cos(\big(k-l\big)x_j)\Big) \\
  \sin(kx_j)\sin(lx_j) = \tfrac{1}{2}\Big(\cos(\big(k-l\big)x_j) - \cos(\big(k+l\big)x_j)\Big) \\
  \cos(kx_j)\sin(lx_j) = \tfrac{1}{2}\Big(\sin(\big(k+l\big)x_j) - \sin(\big(k-l\big)x_j)\Big) \\
\end{align*}
verwendet und die Aussagen des folgenden Satzes angewendet
\begin{colbox}{Satz}
  Es sei $N=2n$, mit $n\in\mathbb{N}$. Da Fourier-Polynom
  \begin{align*}
  g_n^*(x) := \tfrac{1}{2}a^*_0 + \sum_{k=1}^{m}\{a^*_k\cos(kx)+b^*_k\sin(kx)\}
  \end{align*}
  von Gram $m<n$ mit Koeffizienten $a_k^*$ und $b^*_k$ approximiert die Funtkion $f(x)$ im diskreten quadratischen 
  Mittel der $N$ Stützstellen $x_j$ derart, dass die Summe der Quadrate der Abweichungen
  \begin{align*}
  F:=\sum_{j=1}^{N}\{g^*_n(x_j)-f(x_k)\}^2
  \end{align*}
  minimal ist.
\end{colbox}
\begin{egbox}
  Sei $f(x)=x^2$: \\
  \textcolor{red}{$x^2$ Plot} 
\end{egbox}

\subsection{Effiziente Berechnung der Fourier-Koeffizienten}
Die näherungsweise Berechnung der Fourier-Koeffizienten $a_k^*$ und $b_k^*$ ist für eine große Anzahl $N$ der 
Stützstellen sehr aufwendig. \\
Dies ist vorallem bei der diskreten Fouriertransformation relevant, die in Ingenieur- und Naturwissenschaften 
häufig eingesetzt wird, um z.B. die Frequenzen von Vibrationen. \\
$\implies$ Aufwand $\propto N^2$ ($N^2$ trigonometrischen Funktionsauswertungen). Problem bei $N\gg 1000$ \\
Runge 1903, 1905, sowie verchiedene unabhängige Arbeiten vieler Mathematiker.
\subsection{Schnelle Fourier-Transformation (Details)}
Zur Berechnung der Summe
\begin{align*}
  a'_k := \sum_{j=0}^{N-1} f(x_j)\cos(kx_j), \quad k=0,1,\dots,\tfrac{N}{2} \\
  b'_k := \sum_{j=0}^{N-1} f(x_j)\cos(kx_j), \quad k=1,2,\dots,\tfrac{N}{2}-1 
\end{align*}
mit $x_j=\tfrac{2\pi}{N}\cdot j$, kann für den Spezialfall, in dem $N$ eine Potenz von $2$ ist, ein sehr effizienter 
Algorithmus entwickelt werden, wenn man zu einer komplexen Fouriertransformation übergeht. \\
Aus zwei aufeinanderfolgenden Stützwerten bildet man die $n=N\,/\,2$ komplexen Zahlenwert:
\begin{align*}y_j := f(x_{2j}) + i\cdot f(x_{2j+1}),\qquad \text{für } j=0,1,\dots,n-1\end{align*}
\begin{defbox}[Diskrete komplexe Fouriertransformation der Ordnung $n$:]
  \begin{align*}
    c_k := \sum_{j=0}^{n-1} y_j\cdot \exp\left(ijk\dfrac{2\pi}{n}\right) = \sum_{j=0}^{n-1} y_j\cdot \omega_n^{jk}
  \end{align*}
  mit 
  \begin{align*}\omega_n := \exp\left(-i\cdot\dfrac{2\pi}{n}\right) = \cos\left(\dfrac{2\pi}{n}\right)+i\cdot\sin\left(\dfrac{2\pi}{n}\right)\end{align*}
  Dabei sind die $\omega_n$ die $n$-ten Einheitswurzeln.
\end{defbox}
\newpage
\begin{colbox}{Satz}[Zusammenhang zwischen reellwertigen und komplexen Fourier-Transformation]
  Die reellwertigen trigonometrischen Summen $a_k'$ und $b_k'$ sind gegeben durch die komplexen 
  Fourier-Transformierten $c_k$ durch:
  \begin{align*}
  a_k'-ib_k'&=\tfrac{1}{2}(c_k+\overline{c_{n-k}}) + \tfrac{1}{2i}(c_k-\overline{c_{n-k}})e^{\tfrac{-ik\pi}{n}} \\
  a_{n-k}'-ib_{n-k}'&=\tfrac{1}{2}(\overline{c_k}+c_{n-k}) + \tfrac{1}{2i}(\overline{c_k}-c_{n-k})e^{\tfrac{ik\pi}{n}}
  \end{align*}
  für $k=0,\dots n$ falls $b_0'=b_n'=0$ und $c_n=c_0$
\end{colbox}
\textit{Beweis.} 
Für den ersten Summanden der oberen Formel erhält man 
\begin{align*}
  \dfrac{1}{2}\left(c_k+\overline{c_{n-k}}\right) 
  &= \dfrac{1}{2}\cdot\sum_{j=0}^{n-1}\left\{y_j\cdot\omega_n^{jk} + \overline{y_j}\cdot\overline{\omega_n^{j(n-k)}}\right\} \\
  &= \dfrac{1}{2}\cdot\sum_{j=0}^{n-1}\left(y_j+\overline{y_j}\right)\cdot\omega_n^{jk}
\end{align*}
Für den Ausdruck in Klammern des 2. Summanden \textcolor{red}{prüfen, glaube - statt +}
\begin{align*}
  \dfrac{1}{2i}\left(c_k+\overline{c_{n-k}}\right) 
  &= \dfrac{1}{2i}\cdot\sum_{j=0}^{n-1}\left\{y_j\cdot\omega_n^{jk} + \overline{y_j}\cdot\overline{\omega_n^{j(n-k)}}\right\} \\
  &= \dfrac{1}{2}\cdot\sum_{j=0}^{n-1}\left(y_j+\overline{y_j}\right)\cdot\omega_n^{jk}
\end{align*}
Mit Definition von $y_j$ folgt
\begin{align*}
  &\dfrac{1}{2}\left(c_k+\overline{c_{n-k}}\right) - \dfrac{1}{2i}\left(c_k+\overline{c_{n-k}}\right)e^{-\tfrac{ik\pi}{n}}\\
  &= \sum_{j=0}^{n-1}\left\{f(x_{2j})e^{-ijk\tfrac{2\pi}{n}}+f(x_{2j+1})e^{-i(2j+1)k\tfrac{\pi}{n}}\right\} \\
  &= \sum_{j=0}^{n-1}\left\{f(x_{2j})\left[\cos(kx_{2j})-i\sin(kx_{2j})\right]
  + f(x_{2j+1})\left[\cos(kx_{2j+1})-i\sin(kx_{2j+1})\right]\right\} \\
  &= a_k' - ib_k'
\end{align*}
Die zweite Formel des Satzes ergibt sich durch Substitution von $k$ durch $n-k$. 
\qed\\ \\
Die Reduktion einer komplexen Fouriertransformation von gerader Ordnung auf zwei Fouriertransformationen je der halben
Ordnung ist möglich. \\
Diese Reduktion der Ordnung wird iterativ durchgeführt: \\ \\
Es sei $n=2m$, $m\in\mathbb{N}$. Dann gilt für die komplexe Fouriertransformierte $c_k$ mit geraden Indizes 
$k=2l$, $l=0,1,\dots,m-1$:
\begin{align*}
  c_{2l} = \sum_{j=0}^{2m-1}y_j\omega_n^{2lj} = \sum_{j=0}^{m-1} (y_j+y_{m+j})\omega_n^{2lj}
\end{align*}
Dabei wurde die Identität 
\begin{align*}
  \omega_n^{2l(m+j)} 
  = \omega_n^{2lj}\cdot \omega_n^{2lm} 
  = \omega^{2lj}\cdot \omega_n^{ln} = \omega_n^{2lj}\cdot \left(e^{-i\tfrac{2\pi}{n}}\right)^{2ln} 
  = \omega_n^{2lj}\cdot \left(e^{-i\cdot2\pi}\right)^l 
  = \omega_n^{2lj}
\end{align*}
Mit den $m$ Hilfswerten 
\begin{align*}
  z_j := y_j + y_{m+j}, \quad j=0,\dots,m-1
\end{align*}
und wegen $\omega_n^2 = \omega_m$ sind die Koeffizienten 
\begin{align*}
  c_{2l} = \sum_{j=0}^{m-1} z_jw_m^{jl}
\end{align*}
die Fouriertransformierten der Ordnung $m$ der Hilfswerte $z_j$. \\
Für die $c_k$ mit ungeraden Indizes $k=2l+1$ mit $l=0,1,\dots,m-1$ gilt 
\begin{align*}
  c_{2l+1} &= \sum_{j=0}^{2m-1} y_j\omega_n^{(2l+1)j} \\
  &= \sum_{j=0}^{m-1}\left\{ y_j\omega_n^{(2l+1)j}+y_{j+m}\omega_n^{(2l+1)(n+j)}\right\}\\
  &= \sum_{j=0}^{m-1}(y_j-y_{m+j})\omega_n^{(2l+1)j} \\
  &= \sum_{j=0}^{m-1}(y_j-y_{m+j})\omega_n^{j}\cdot\omega_n^{2lj}
\end{align*}
Mit den weiteren $m$ Hilfswerten
\begin{align*}
  z_{m+j} := (y_j-y_{m+j})\omega_n^j,\quad j=0,1,\dots,m-1
\end{align*}
sind die Koeffizienten
\begin{align*}
  c_{2l+1} = \sum_{j=0}^{m-1} z_{m+j} \omega_m^{jl}, \quad l=0,1,\dots,m-1
\end{align*}
die Fouriertransformierten der Ordnung $m$ der Hilfswerte $z_{m+j}$. \\
Die Zurückführung einer komplexen Fouriertransformationen der Ordnung $n=2m$ auf $2$ komplexe Fouriertransformationen 
der Ordnung $m$ erfordert nach den obigen Formeln als wesentlichen Rechenaufwand $m$ komplexe Multiplikationen. \\
In die Ordnung $n=2^\gamma$, $\gamma\in\mathbb{N}$, so kann die Reduktion auf $2$ Fouriertransformationen halber Ordnung
iterativ durchgeführt werden. \\
\begin{egbox}
  $FT_{32} \to 2FT_{16}\to 4FT_8 \to 8FT_4 \to 16FT_2\to 32FT_1$
\end{egbox}
Da jeder Schritt $n\,/\,2$ komplexe Multiplikationen fordert, beträgt der gesamte Rechenaufwand
\begin{align*}
  z_{FT,n} = \tfrac{1}{2}n\gamma = \tfrac{1}{2}n\log_2 n
\end{align*}
