% !TeX root = ../script.tex
\section{Wiederholung}

Wir starten mit einer kurzen Wiederholung zur Fixpunktiteration zum Lösen von Gleichungen 
der Form $Tx=x$ durch die Iterationsvorschrift $x^{(n+1)}=Tx^{(n)}$.

\begin{colbox}{Satz}[Banach 1922]
  Sei $M$ eine abgeschlossene nichtleere Teilmenge in einem vollständig metrischem Raum $(X,d)$ 
  und $T:M\rightarrow M$ eine Selbstabbildung (d.h. $T(M)\subset M$ ) und $k$-kontraktiv (d.h. 
  $d(Tx,Ty)\leq k\cdot d(x,y)\ \forall x,y\in M$ 
  mit $0\leq k < 1$). Dann folgt:
  \begin{enumerate}
    \item Existenz und Eindeutigkeit: die Gleichung $Tx=x$ hat genau eine Lösung, d.h. $T$ hat genau einen 
    Fixpunkt in der Menge $M$.
    \item Konvergenz der Iteration $x^{(k+1)}=Tx^{(k)}$. Die Folge $(x^{(k)})_{k\in\N}$ konvergiert gegen den 
    Fixpunkt $\hat{x}$ für einen beliebigen Startpunkt $x^{(0)}\in M$.
    \item Fehlerabschätzung: Für alle $n=0,1,\dotsc$ gilt 
    \begin{itemize}
      \item a-priori: $d(x^{(n)},\hat{x})\leq k^n(1-k)^{-1}d(x^{(0)},x^{(1)})$
      \item a-posteriori: $d(x^{(n+1)},\hat{x})\leq k(1-k)^{-1}d(x^{(n)},x^{(n+1)})$
    \end{itemize}
    \item Konvergenzrate: Für alle $n\in\N$ gilt $d(x^{(n+1)},\hat{x})\leq k\cdot d(x^{(n)},\hat{x})$
  \end{enumerate}
\end{colbox}

\textit{Beweis.} 
\begin{enumerate}
  \item[2.] 
  Wir zeigen, dass $(x^{(n)})$ eine Cauchy-Folge ist: Für den Abstand zweier benachbarter Folgeglieder $x^{(n)}$ 
  und $x^{(n+1)}$ gilt
  %
  \begin{align*}
    d(x^{(n)},x^{(n+1)}) 
    = d(Tx^{(n-1)},Tx^{(n)}) 
    \leq k\cdot d(x^{(n-1)},x^{(n)}) 
    \leq 
    \dotsc 
    \leq k^n\cdot d(x^{(0)},x^{(1)})
  \end{align*}
  %
  Mehrfache Anwendung der Dreiecksungleichung liefert daher für $n,m\in\N$:
  %
  \begin{align*}
    d(x^{(n)},x^{(n+m)}) 
    &\leq d(x^{(n)},x^{(n+1)}) + d(x^{(n+1)},x^{(n+2)}) + \dotsc + d(x^{(n+m-1)}, x^{(n+m)}) \\
    & \leq (k^n + k^{n+1} + \dotsc + k^{n+m})\cdot d(x^{(0)},x^{(1)}) \\
    & \leq k^n(1+k+k^2+\dotsc)\cdot d(x^{(0)},x^{(1)}) \\
    & = k^n\cdot(1-k)^{-1}d(x^{(0)},x^{(1)})
  \end{align*}
  %
  Demnach folgt $d(x^{(n)},x^{(n+m)})\rightarrow 0$ für $n\rightarrow \infty$ und da $X$ vollständig ist 
  konvergiert $(x^{(n)})$ gegen ein $\hat{x}\in X$.

  \item[1.] 
  Da $T$ stetig ist (aufgrund der $k$-Kontraktivität) folgt für die konvergente Folge $(x^{(n)})$, dass 
  %
  \begin{align*}
    \hat{x} = \lim_{n\rightarrow\infty} x^{(n+1)} = \lim_{n\rightarrow\infty} Tx^{(n)} = T\hat{x}
  \end{align*}
  %
  Da $M$ abgeschlossen ist existiert also ein Fixpunkt in $M$. 

  Dieser ist eindeutig, denn für $x,y$ mit $Tx=x$ und $Ty=y$ gilt $d(x,y)=d(Tx,Ty)\leq k d(x,y)$, also $d(x,y)=0$ und 
  damit $x=y$ (Definitheit der Metrik).

  \item[3.] 
  Aus dem Beweis zu 2. haben wir $d(x^{(n)},x^{(n+m)})\leq k^n(1-k)^{-1}d(x^{(0)},x^{(1)})$, wegen der Stetigkeit 
  der Metrik folgt die a-priori-Fehlerabschätzung aus $m\rightarrow\infty$. 

  Die a-posteriori-Fehlerabschätzung folgt analog aus dem Ansatz
  %
  \begin{align*}
    d(x^{(n+1)},x^{(n+1+m)}) &\leq d(x^{(n+1)},x^{(n+2)}) + \dotsc + d(x^{(n+m)}, x^{(n+1+m)}) \\
    & \leq (k + \dotsc + k^{m})\cdot d(x^{(n)},x^{(n+1)}) \\
    & \leq k(1+k+k^2+\dotsc)\cdot d(x^{(n)},x^{(n+1)}) \\
    & =C k\cdot(1-k)^{-1}d(x^{(n)},x^{(n+1)})
  \end{align*}
  %
  \item[4.] 
  Folgt direkt durch $d(x^{(n+1)},\hat{x})=d(Tx^{(n)},T\hat{x})\leq k\cdot d(x^{(n)},\hat{x})$ 

  \qed
\end{enumerate}

\begin{colbox}{Beispiel} 
  Wir betrachten das Nullstellenproblem $f:\R\rightarrow\R, x\mapsto \cos x - x = 0$. \\
  Umformung ergibt $\underbrace{\cos x}_{Tx} = x$ und somit die Fixpunktiteration $x^{(k+1)}=Tx^k=\cos(x^{(k)})$ \\
  
  \begin{center}
    \input{figures/fixpointCosFigure.tikz}
  \end{center}
  
  \underline{Prüfung der Voraussetzungen des Banach'schen FP-Satzes:}

  Wir wählen als Einschränkung $M=[0,1]$, dies liefert uns eine Selbstabbildung auf einer abgeschlossenen 
  Teilmenge $M$ des vollständig metrischen Raum $\R$ mit der Abstandsfunktion $ d(x,y) = |x-y|$. 

  Weiter ist die Abbildung $k$-kontraktiv, denn nach dem Mittelwertsatz der Differentialrechnung gilt 
  %
  \begin{align*}
    |\cos x - \cos y| 
    = \underbrace{|\sin \xi|}_{\leq \sin(1)}\cdot|x-y|
    \leq \underbrace{0,85}_{=:k}\cdot |x-y|, 
    \quad \text{für } \xi\in[0,1]
  \end{align*}
  %
  Wir können also nach Banach die Existenz und Eindeutigkeit eines Fixpunkt $\hat{x}$ folgern, diesen Fixpunkt 
  finden wir durch die konvergente Folge $x^{(k+1)}=\cos x^k$. 
\end{colbox}

Wir betrachten im folgenden die Idee der Umwandlung eines Nullstellenproblems in Fixpunkt-Gleichung noch etwas 
allgemeiner. Für eine Gleichung $f(x)=0$ mit $f:\R\rightarrow\R$ haben wir verschiedene Möglichkeiten 
zur Umformung:

\begin{enumerate}
  \item[a)] Betrachte $Tx := x-f(x)$ gefolgert aus $f(x)=0\Leftrightarrow -f(x)=0 \Leftrightarrow x-f(x)=x$.
  \item[b)] Betrachte $Tx := x-\omega \cdot f(x)$ mit $\omega\neq 0$ (lineare Relaxation)
  \item[c)] Betrachte $Tx:=x-\omega \cdot g(f(x))$ mit $\omega \neq 0$ und geeigneter Funktion $g$ 
  (nichtlineare Relaxation). Wenn $g(0)\neq 0$ dann betrachte $Tx:=x-\omega\cdot(g(f(x))+g(0))$
  \item[d)] Betrachte $Tx:=x-(f'(x))^{-1} f(x)$ (Newtonverfahren).
  Newton hat teils Probleme, bei falschen Startwerten: 

  \begin{center}
    \input{figures/newtonProblemFigure.tikz}
  \end{center}

  \item[e)] Betrachte $Tx:=h^{-1}(f(x)-g(x))$, wobei $f(x)=h(x)+g(x)$ (Splitting-Verfahren) 
\end{enumerate}